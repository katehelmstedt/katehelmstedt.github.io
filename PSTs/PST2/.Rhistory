load("/Users/helmstek/Dropbox/Work/000_Projects/2021-/Food waste and BD/R, excel/20Jan17.RData")
# Draw chord diagrams for each commodity
require(circlize)
ctr=1
#tWNoLoop<-tradeWaste#Commod[,,ctr]
tWNoLoop<-initWaste#Commod[,,ctr]
#for (rctr in 1:nrow(tradeWaste)){tWNoLoop[rctr,rctr]<-0}
for (rctr in 1:nrow(initWaste)){tWNoLoop[rctr,rctr]<-0}
grid.col = c("yellow", "red", "orange", "grey", "blue", "chartreuse4", "blueviolet")
#circos.par(gap.degree = c(rep(20, nrow(tradeWaste))))
circos.par(gap.degree = c(rep(20, nrow(initWaste))))
chordDiagram(tWNoLoop, grid.col=grid.col,order=c("IA", "EU", "SubSA", "NAWCA", "SSEA", "LA", "NAO" ), #link.sort = decreasing,
directional = 1, diffHeight=0.1,
annotationTrackHeight = c(0.01, 0.02),
transparency = 0.1)
initWaste
TWdf
# Draw alluvial plots showing waste patterns
require(alluvial)
par(mar = c(0, 1, 0, 1))
TWdf<-cbind(expand.grid(regions, regions), matrix(NA, nrow=length(regions)^2, ncol=2))
colnames(TWdf)<-c("Producer", "Consumer", "Waste", "col")
TWdf<-as.data.frame(TWdf)
#vcols<-c(rep("white",429), magma(571, begin=0.90, end=0))
#vcols<-brewer.pal(100, "PuBu")#magma(1000, begin=0.90, end=0)
colfunc <- colorRampPalette(c("#E0E0E7", "#023858"))
vcols<-colfunc(100)
col.min<-min(tradeWaste)
col.max<-max(tradeWaste)
col.diff<-col.max-col.min
for (ctr in 1:nrow(TWdf)){
#  if (TWdf[ctr, "Producer"]!=TWdf[ctr, 'Consumer']){
TWdf[ctr,"Waste"] <- tradeWaste[TWdf[ctr, "Producer"], TWdf[ctr, 'Consumer']]
TWdf[ctr,"col"]<-vcols[floor(99*((TWdf[ctr,"Waste"]-col.min)/col.diff))+1]
#  }else{
#    TWdf[ctr,"Waste"]<-0
#    TWdf[ctr,"col"]<-"White"
#  }
}
alluvial(TWdf[,1:2], freq=TWdf$Waste, border=NA, col=TWdf$col, #hide = TWdf$Waste < mean(TWdf$Waste),
gap.width=0.3, alpha=0.8, cex.axis=1, cw=0.01, xw=0.1, blocks=TRUE)
?alluvial
alluvial(TWdf[,1:2], freq=TWdf$Waste, border=NA, col=TWdf$col)#, #hide = TWdf$Waste < mean(TWdf$Waste),
TWdf
alluvial(log(TWdf[,1:2]), freq=TWdf$Waste, border=NA, col=TWdf$col)#, #hide = TWdf$Waste < mean(TWdf$Waste),
alluvial(TWdf[,1:2], freq=log(TWdf$Waste), border=NA, col=TWdf$col)#, #hide = TWdf$Waste < mean(TWdf$Waste),
alluvial(TWdf[,1:2], freq=(TWdf$Waste)^10, border=NA, col=TWdf$col)#, #hide = TWdf$Waste < mean(TWdf$Waste),
alluvial(TWdf[,1:2], freq=(TWdf$Waste)^2, border=NA, col=TWdf$col)#, #hide = TWdf$Waste < mean(TWdf$Waste),
alluvial(TWdf[,1:2], freq=(TWdf$Waste)^5, border=NA, col=TWdf$col)#, #hide = TWdf$Waste < mean(TWdf$Waste),
alluvial(TWdf[,1:2], freq=(TWdf$Waste)^5, border=NA, col=TWdf$col, #hide = TWdf$Waste < mean(TWdf$Waste),
gap.width=0.3, alpha=0.8, cex.axis=1, cw=0.01, xw=0.1, blocks=TRUE)
# CEED
#
justine<-'MtfN9OAAAAAJ'
salit<-'ZZRWgsgAAAAJ'
martine<-'7bwcNZsAAAAJ'
ceed_people<-c(kate, justine, salit, martine)
kate<-'qhSrJKcAAAAJ'
ceed_people<-c(kate, justine, salit, martine)
ceed<-compare_scholar_careers(qut_people, career = TRUE) %>%
filter(year<2021)%>%
filter(career_year<20)%>%
ggplot(aes(career_year, cites, color=name)) +
geom_line()+
theme_bw()
library(scholar)
library(dplyr)
library(ggplot2)
install.packages("scholar")
library(scholar)
# CEED
#
justine<-'MtfN9OAAAAAJ'
salit<-'ZZRWgsgAAAAJ'
martine<-'7bwcNZsAAAAJ'
ceed_people<-c(kate, justine, salit, martine)
ceed<-compare_scholar_careers(qut_people, career = TRUE) %>%
filter(year<2021)%>%
filter(career_year<20)%>%
ggplot(aes(career_year, cites, color=name)) +
geom_line()+
theme_bw()
ceed<-compare_scholar_careers(ceed_people, career = TRUE) %>%
filter(year<2021)%>%
filter(career_year<20)%>%
ggplot(aes(career_year, cites, color=name)) +
geom_line()+
theme_bw()
ceed
ceed<-compare_scholar_careers(ceed_people, career = TRUE) %>%
filter(year<2021)%>%
filter(career_year<25)%>%
ggplot(aes(career_year, cites, color=name)) +
geom_line()+
theme_bw()
ceed
ceed<-compare_scholar_careers(ceed_people, career = TRUE) #%>%
ceed
?mutate_if
ceed %>%
mutate_if(id==justine, career_year==career_year+5)
ceed %>%
mutate_if((id==justine), career_year==career_year+5)
ceed %>%
mutate_if((id=='MtfN9OAAAAAJ'), career_year==career_year+5)
